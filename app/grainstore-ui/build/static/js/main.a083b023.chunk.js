(this["webpackJsonpgrainstore-ui"]=this["webpackJsonpgrainstore-ui"]||[]).push([[0],{110:function(e,t,a){},168:function(e,t,a){e.exports=a(285)},173:function(e,t,a){},180:function(e,t,a){},181:function(e,t,a){},182:function(e,t,a){},183:function(e,t,a){},184:function(e,t,a){},285:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(42),l=a.n(c),o=a(20),u=(a(173),a(9)),s=a.n(u),i=a(14),m=a(15),p=a(10),d=a(48),E=a(307),h=a(308),f=a(156),g=(a(180),a(181),{cognito:{REGION:"eu-west-2",USER_POOL_ID:"eu-west-2_9E8x3OLUG",APP_CLIENT_ID:"34q2kn7hddiru0njfkevden2hr"},apiGateway:{REGION:"eu-west-2",URL:"https://aojuwiinsb.execute-api.eu-west-2.amazonaws.com/dev"},app:{VERSION:"0.1.0"}});a(182);function v(){return r.a.createElement("div",{className:"Home"},r.a.createElement("div",{className:"lander"},r.a.createElement("h1",null,"Grainstore UI"),r.a.createElement("p",null,"A simple UI for querying Grainstore Data")))}a(183);function b(){return r.a.createElement("div",{className:"NotFound"},r.a.createElement("h3",null,"Sorry, page not found!"))}var y=a(297),k=a(309),O=a(310),I=a(298),j=(a(184),a(305)),w=Object(n.createContext)(null);function x(){return Object(n.useContext)(w)}function T(){var e=x().userHasAuthenticated,t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(""),u=Object(m.a)(o,2),d=u[0],E=u[1],h=Object(p.k)();function f(){return(f=Object(i.a)(s.a.mark((function t(a){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,j.a.signIn(c,d);case 4:e(!0),h.push("/"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),alert(t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}return r.a.createElement("div",{className:"Login"},r.a.createElement("form",{onSubmit:function(e){return f.apply(this,arguments)}},r.a.createElement(y.a,{controlId:"username"},r.a.createElement(k.a,null,"Username"),r.a.createElement(O.a,{autoFocus:!0,type:"username",value:c,onChange:function(e){return l(e.target.value)}})),r.a.createElement(y.a,{controlId:"password"},r.a.createElement(k.a,null,"Password"),r.a.createElement(O.a,{value:d,onChange:function(e){return E(e.target.value)},type:"password"})),r.a.createElement(I.a,{block:!0,disabled:!(c.length>0&&d.length>0),type:"submit"},"Login")))}a(110);var N=a(304),D=a(299),S=a(154),A=a(300);function U(e){var t=e.toString();e instanceof Error||!e.message||(t=e.message),alert(t)}function C(){var e=Object(p.m)().customerId,t=Object(n.useState)([]),a=Object(m.a)(t,2),c=a[0],l=a[1],o=x().isAuthenticated,u=Object(n.useState)(!0),E=Object(m.a)(u,2),h=E[0],f=E[1],g=Object(p.k)();function v(){return b.apply(this,arguments)}function b(){return(b=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loading more records"),e.prev=1,e.next=4,y();case 4:t=e.sent,l(t),f(!1),O(c),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),U(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function y(){return k.apply(this,arguments)}function k(){return(k=Object(i.a)(s.a.mark((function t(){var a,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("loading more records"),t.next=3,j.a.currentAuthenticatedUser();case 3:return a=t.sent,n=a.signInUserSession.accessToken.jwtToken,r={body:{Account:e,LastEvaluatedKey:{Account:c.NextRecord.Account,Timestamp:c.NextRecord.Timestamp}},headers:{Authorization:n,"Content-Type":"application/json"}},t.abrupt("return",N.a.post("grainstore-api","/getrecord",r));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(t){console.log("rendering");var a="";if(t.Count>0&&(console.log("records found"),a=[{}].concat(t.Items).map((function(t,a){return 0!==a?r.a.createElement(d.LinkContainer,{key:t.UUID,to:{pathname:"/results/".concat(e,"/").concat(t.UUID),state:{recordData:t}}},r.a.createElement(D.a,null,r.a.createElement(S.a,{action:"true"},r.a.createElement("h3",null,"TicketID: ",t.TicketID),r.a.createElement("b",null,"Date:")," ",t.Timestamp.split("T",1,0)," ",r.a.createElement("b",null,"Time:")," ",t.Timestamp.substring(11,19),r.a.createElement("br",null),r.a.createElement("b",null,"Vehicle Reg")," ",t.VehicleReg))):r.a.createElement(d.LinkContainer,{key:e,to:"/results/".concat(e)},r.a.createElement(S.a,null,r.a.createElement("h4",null,r.a.createElement("b",null,"Click Ticket Below For Details:"))))}))),"undefined"!==typeof t.NextRecord){var n=t.NextRecord.Account,c=t.NextRecord.Timestamp;console.log("there is more. next record --\x3e Account: "+n+" Timestamp: "+c),a.push(r.a.createElement(I.a,{variant:"primary",key:"paginator",size:"lg",block:!0,onClick:v},"Show more Records")),a.push(r.a.createElement(I.a,{variant:"primary",key:"goback",size:"lg",block:!0,onClick:g.goBack},"Go Back"))}return a}return Object(n.useEffect)((function(){function t(){return a.apply(this,arguments)}function a(){return(a=Object(i.a)(s.a.mark((function t(){var a,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.a.currentAuthenticatedUser();case 2:return a=t.sent,n=a.signInUserSession.accessToken.jwtToken,r={body:{Account:e},headers:{Authorization:n,"Content-Type":"application/json"}},t.abrupt("return",N.a.post("grainstore-api","/getrecord",r));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function n(){return(n=Object(i.a)(s.a.mark((function e(){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:a=e.sent,l(a),f(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),U(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[e]),r.a.createElement("div",{className:"Home"},o?function(){var t="Searching for records...";return"undefined"===typeof c.Count?console.log("No records yet"):t=0===c.Count?"No Records Found":e.match(/^\d*$/)?"Ticket ID: "+e:"Account: "+e.toUpperCase(),r.a.createElement("div",{className:"records"},r.a.createElement(A.a,null,r.a.createElement("h2",null,t)),r.a.createElement(D.a,null,!h&&O(c)))}():r.a.createElement("div",{className:"lander"},r.a.createElement("h1",null,"Grainstore UI"),r.a.createElement("p",null,"You must login first")))}var R=a(301),L=a(302),G=a(303);function P(){var e=Object(p.l)().state.recordData,t=Object(n.useState)([]),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(!0),u=Object(m.a)(o,2),d=u[0],E=u[1],h=x().isAuthenticated;return Object(n.useEffect)((function(){function t(){return a.apply(this,arguments)}function a(){return(a=Object(i.a)(s.a.mark((function t(){var a,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.a.currentAuthenticatedUser();case 2:return a=t.sent,n=a.signInUserSession.accessToken.jwtToken,r={body:{UUID:e.UUID,ImageKey:e.ImageKey},headers:{Authorization:n,"Content-Type":"application/json"}},console.log("Fetching signed URL for Image"),t.abrupt("return",N.a.post("grainstore-api","/publishimage",r));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function n(){return(n=Object(i.a)(s.a.mark((function e(){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:a=e.sent,l(a),E(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),U(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[e]),r.a.createElement("div",{className:"Data"},r.a.createElement("h1",null,r.a.createElement(G.a,{variant:"primary"},"Account:"),r.a.createElement(G.a,{variant:"light"},e.Account)),r.a.createElement("h1",null,r.a.createElement(G.a,{variant:"secondary"},"TicketID:"),r.a.createElement(G.a,{variant:"light"},e.TicketID)),h?!d&&function(){var t=new Date(e.Timestamp);return console.log(t.toLocaleTimeString()),r.a.createElement(R.a,{striped:!0,bordered:!0,hover:!0,variant:"dark"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Key"),r.a.createElement("th",null,"Value"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Record Datetime"),r.a.createElement("td",null,t.toLocaleDateString(),"  -  ",t.toLocaleTimeString())),r.a.createElement("tr",null,r.a.createElement("td",null,"Crop"),r.a.createElement("td",null,e.Crop)),r.a.createElement("tr",null,r.a.createElement("td",null,"Direction"),r.a.createElement("td",null,e.Direction)),r.a.createElement("tr",null,r.a.createElement("td",null,"Vehicel Reg"),r.a.createElement("td",null,e.VehicleReg)),r.a.createElement("tr",null,r.a.createElement("td",null,"Admix"),r.a.createElement("td",null,e.AdmixPct," %")),r.a.createElement("tr",null,r.a.createElement("td",null,"Bushel Weight"),r.a.createElement("td",null,e.BushelKg," Kg")),r.a.createElement("tr",null,r.a.createElement("td",null,"Dry Weight "),r.a.createElement("td",null,e.DryWeightTonnes," tonnes")),r.a.createElement("tr",null,r.a.createElement("td",null,"Moisture"),r.a.createElement("td",null,e.MoisturePct," %")),r.a.createElement("tr",null,r.a.createElement("td",null,"Wet Weight"),r.a.createElement("td",null,e.WetWeightTonnes," tonnes")),r.a.createElement("tr",null,r.a.createElement("td",null,"Sample Bag"),r.a.createElement("td",null,r.a.createElement(L.a,{src:c,rounded:!0,fluid:!0})))))}():r.a.createElement("div",{className:"lander"},r.a.createElement("h1",null,"Grainstore UI"),r.a.createElement("p",null,"You must login first")))}function _(){return r.a.createElement(p.g,null,r.a.createElement(p.d,{exact:!0,path:"/"},r.a.createElement(v,null)),r.a.createElement(p.d,{exact:!0,path:"/login"},r.a.createElement(T,null)),r.a.createElement(p.d,{exact:!0,path:"/results/:customerId"},r.a.createElement(C,null)),r.a.createElement(p.d,{exact:!0,path:"/results/:customerId/:record"},r.a.createElement(P,null)),r.a.createElement(p.d,null,r.a.createElement(b,null)))}a(284);var B=function(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(!0),u=Object(m.a)(l,2),v=u[0],b=u[1];Object(n.useEffect)((function(){!function(){T.apply(this,arguments)}()}),[]);var y=Object(p.k)(),k=Object(n.useState)(""),O=Object(m.a)(k,2),I=O[0],x=O[1];function T(){return(T=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.a.currentSession();case 3:c(!0),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),"No current user"!==e.t0&&alert(e.t0);case 9:b(!1);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function N(){return(N=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.signOut();case 2:c(!1),y.push("/login");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return!v&&r.a.createElement("div",{className:"App container"},r.a.createElement(E.a,{collapseOnSelect:!0},r.a.createElement(E.a.Brand,null,r.a.createElement("h1",null,r.a.createElement(o.Link,{to:"/"},"Grainstore UI"))),r.a.createElement(E.a.Toggle,null),r.a.createElement(E.a.Collapse,null,r.a.createElement(h.a,null,a?r.a.createElement(f.a,{onClick:function(){return N.apply(this,arguments)}},"Logout"):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.LinkContainer,{to:"/login"},r.a.createElement(f.a,null,"Login"))))),r.a.createElement(h.a,null,a?r.a.createElement(f.a,null,r.a.createElement("form",{className:"form-inline",onSubmit:function(){y.push("/results/"+I)}},r.a.createElement("input",{className:"form-control mr-sm-2",type:"search",placeholder:"Customer or Ticket ID","aria-label":"Customer or Ticket ID",value:I,onChange:function(e){var t=e.target;x(t.value)}}),r.a.createElement("button",{className:"btn btn-outline-success my-2 my-sm-0",type:"submit"},"Search"))):r.a.createElement(r.a.Fragment,null))),r.a.createElement(w.Provider,{value:{isAuthenticated:a,userHasAuthenticated:c}},r.a.createElement(_,null)),r.a.createElement("footer",{id:"sticky-footer"},r.a.createElement("div",{className:"container text-center"},r.a.createElement("small",null,"Grainstore UI Version: ",g.app.VERSION))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(66).a.configure({Auth:{mandatorySignIn:!0,region:g.cognito.REGION,userPoolId:g.cognito.USER_POOL_ID,identityPoolId:g.cognito.IDENTITY_POOL_ID,userPoolWebClientId:g.cognito.APP_CLIENT_ID},API:{endpoints:[{name:"grainstore-api",endpoint:g.apiGateway.URL,region:g.apiGateway.REGION}]}}),l.a.render(r.a.createElement(o.BrowserRouter,null,r.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[168,1,2]]]);
//# sourceMappingURL=main.a083b023.chunk.js.map